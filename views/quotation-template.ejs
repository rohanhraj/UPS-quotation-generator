<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ARVI Power - Quotation</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            font-family: 'Open Sans', Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.4;
            color: #333;
            background: white;
            -webkit-print-color-adjust: exact;
        }

        /* 
           Wrapper for the whole document to handle footer placement.
           Using flex column with height 100vh ensures the footer stays at bottom of last page.
        */
        .doc-wrapper {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 15mm 15mm 0 15mm;
        }

        .content-area {
            flex: 1;
        }

        /* Header */
        .header {
            width: 100%;
            margin-bottom: 8mm;
            text-align: center;
        }

        .header-img {
            width: 100%;
            height: auto;
        }

        /* Blue Headers - Exact matching of Arvi style */
        .blue-header {
            background: #5a6a7a;
            color: white;
            text-align: center;
            padding: 3mm;
            font-weight: 600;
            font-size: 11pt;
            margin: 6mm 0 4mm;
        }

        .red-bold {
            color: #c41e3a;
            font-weight: 700;
        }

        /* Reference Box */
        .ref-box {
            margin: 5mm 0;
            font-size: 10pt;
        }

        .ref-box p {
            margin: 1.5mm 0;
        }

        .rich-text p { margin-bottom: 1.5mm; }
        .rich-text ul, .rich-text ol { padding-left: 6mm; margin-bottom: 3mm; }
        .rich-text li { margin-bottom: 1mm; }

        /* Section Title */
        .section-title {
            font-size: 11pt;
            font-weight: 600;
            margin: 5mm 0 3mm;
        }

        /* Content Block mirroring the PDF layout */
        .content-block {
            display: flex;
            gap: 8mm;
            margin: 5mm 0;
        }

        .img-stack {
            flex: 0 0 40mm;
            display: flex;
            flex-direction: column;
            gap: 3mm;
        }

        .img-stack img {
            width: 100%;
            border: 1px solid #ddd;
        }

        .text-content {
            flex: 1;
            text-align: justify;
        }

        /* Tables matching the PDF exactly */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 6mm 0;
        }

        th, td {
            border: 1px solid #999;
            padding: 2.5mm 3mm;
            font-size: 9.5pt;
        }

        th {
            background: #e8e8e8;
            font-weight: 600;
            text-align: center;
        }

        .terms-table td:first-child {
            width: 35mm;
            font-weight: 600;
            background: #f5f5f5;
        }

        /* Totals Block */
        .total-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            margin-top: 5mm;
        }

        .total-row {
            display: flex;
            width: 70mm;
            justify-content: space-between;
            padding: 1.5mm 0;
            border-bottom: 1px solid #eee;
        }

        .grand-total-row {
            background: #c41e3a;
            color: white;
            padding: 3mm;
            width: 70mm;
            display: flex;
            justify-content: space-between;
            margin-top: 2mm;
            font-weight: 700;
            border-radius: 1mm;
        }

        /* Signature */
        .signature-area {
            margin-top: 12mm;
            margin-bottom: 15mm;
        }

        /* Footer - FIXED AT BOTTOM OF LAST PAGE */
        .footer {
            width: 100%;
            padding-bottom: 10mm;
            margin-top: auto; /* Pushes to bottom of flex container */
            text-align: center;
        }

        .footer-img {
            width: 100%;
            max-width: 185mm;
            height: auto;
        }

        /* Page Break Support */
        .page-break {
            page-break-before: always;
        }

        @media screen {
            body { background: #f0f0f0; padding: 20px; }
            .doc-wrapper { background: white; width: 210mm; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin: 0 auto; min-height: 297mm; }
        }
    </style>
</head>

<body>
    <div class="doc-wrapper">
        <div class="content-area">
            <!-- HEADER -->
            <div class="header">
                <% if (assetImages['new_header.jpg']) { %>
                    <img src="<%= assetImages['new_header.jpg'] %>" class="header-img">
                <% } %>
            </div>

            <!-- REFERENCE DATA -->
            <div class="ref-box">
                <p><strong>Quotation No:</strong> <%= data.quoteNumber %></p>
                <p><strong>Date:</strong> <%= data.quoteDate %></p>
                
                <div style="margin-top: 3mm;" class="rich-text">
                    <span style="font-weight: 600;">To:</span><br>
                    <%- data.customerName %><br>
                    <%- data.customerAddress %>
                </div>

                <div style="margin-top: 3mm;" class="rich-text">
                    <span style="font-weight: 600;">Kind Attn:</span><br>
                    <%- data.kindAttn %>
                </div>

                <div style="margin-top: 3mm;" class="rich-text">
                    <span style="font-weight: 600;">Ref:</span><br>
                    <%- data.customerRef %>
                </div>
                
                <div style="margin-top: 4mm;" class="rich-text">
                    <%- data.referenceText %>
                </div>
            </div>

            <!-- BRANDING SECTION 1 -->
            <div class="blue-header">What sets Arvi apart from the rest? Let's take a closer look.</div>

            <div class="section-title">1. Truly Indian with <span class="red-bold">75 - 80% local content/ Indian components</span></div>

            <div class="content-block">
                <div class="img-stack">
                    <% if (assetImages['IMG-20260205-WA0004.jpg']) { %>
                        <img src="<%= assetImages['IMG-20260205-WA0004.jpg'] %>">
                    <% } %>
                    <% if (assetImages['IMG-20260205-WA0010.jpg']) { %>
                        <img src="<%= assetImages['IMG-20260205-WA0010.jpg'] %>">
                    <% } %>
                </div>
                <div class="text-content">
                    <p>At a time when self-reliance is driving India’s industrial backbone, Arvi stands out with a 75 – 80% locally designed and manufactured product line. This indigenous approach not only ensures robust quality but also strengthens India’s vision of <strong>“ Make in India.”</strong></p>
                    <p>Many so called manufacturers import UPS as semi knocked down kits and reassemble it in India under Make in India initiative; but the UPS design and its sub assembly are not Indian.</p>
                    <p><em>"Every Arvi UPS is carefully engineered and subjected to 12 rigorous stages of quality inspection and heatrun; ensures minimum 10years of product life."</em></p>
                </div>
            </div>

            <!-- QUOTATION TABLE -->
            <div class="blue-header">Quotation Details</div>

            <div class="section-title">Option I - <span class="rich-text"><%- data.optionTitle %></span></div>
            <div style="font-size: 10pt;" class="rich-text"><%- data.optionSubtitle %></div>
            <div style="margin-top: 2mm; margin-bottom: 2mm;" class="rich-text"><%- data.optionDetails %></div>

            <table>
                <thead>
                    <tr>
                        <th style="width: 12mm;">Sl No</th>
                        <th>Description</th>
                        <th style="width: 28mm;">Unit Price</th>
                        <th style="width: 18mm;">Qty</th>
                        <th style="width: 32mm;">Value</th>
                    </tr>
                </thead>
                <tbody>
                    <% data.items.forEach(function(item) { %>
                    <tr>
                        <td style="text-align: center;"><%= item.slno %></td>
                        <td class="rich-text"><%- item.description %></td>
                        <td style="text-align: right;"><%= item.unitPrice %></td>
                        <td style="text-align: center;"><%= item.qty %></td>
                        <td style="text-align: right;"><%= item.value %></td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>

            <!-- TOTALS -->
            <div class="total-container">
                <div class="total-row"><span>Subtotal:</span> <span>₹ <%= data.subtotal.toLocaleString('en-IN') %></span></div>
                <div class="total-row"><span>GST (18%):</span> <span>₹ <%= data.gstAmount.toLocaleString('en-IN') %></span></div>
                <div class="grand-total-row"><span>Grand Total:</span> <span>₹ <%= data.grandTotal.toLocaleString('en-IN') %></span></div>
            </div>

            <!-- TERMS -->
            <div class="blue-header">Terms & Conditions</div>
            <table class="terms-table" style="margin-top: 0;">
                <tr><td>Price</td><td class="rich-text"><%- data.priceLocation %></td></tr>
                <tr><td>GST</td><td class="rich-text"><%- data.gstTerms %></td></tr>
                <tr><td>Delivery</td><td class="rich-text"><%- data.delivery %></td></tr>
                <tr><td>Payment</td><td class="rich-text"><%- data.payment %></td></tr>
                <tr><td>FAT</td><td class="rich-text"><%- data.fat %></td></tr>
                <tr><td>Warranty</td><td class="rich-text"><%- data.warranty %></td></tr>
                <tr><td>Validity</td><td class="rich-text"><%- data.validity %></td></tr>
                <tr><td>Updates</td><td class="rich-text"><%- data.updates %></td></tr>
            </table>

            <!-- SIGNATURE -->
            <div class="signature-area rich-text">
                <p>Please visit us at www.arviups.com</p>
                <p>Thanking you and assuring you of our best services.</p>
                <p style="margin-top: 6mm;">warm regards,</p>
                <div style="margin-top: 2mm;">
                    <%- data.signName %>
                    <%- data.signDesig %>
                </div>
                <p>For Arvi Systems & Controls Pvt Ltd</p>
            </div>
        </div>

        <!-- FOOTER: FORCED TO BOTTOM OF LAST PAGE -->
        <div class="footer">
            <% if (assetImages['new_footer.jpg']) { %>
                <img src="<%= assetImages['new_footer.jpg'] %>" class="footer-img">
            <% } %>
        </div>
    </div>
</body>

</html>
