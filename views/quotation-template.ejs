<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ARVI Power - Quotation</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.3;
            color: #333;
            background: white;
        }

        .container {
            max-width: 210mm;
            width: 100%;
            margin: 0 auto;
            padding: 15mm 15mm 30mm 15mm;
            position: relative;
            min-height: 100vh;
        }

        /* Header */
        .header {
            width: 100%;
            margin-bottom: 5mm;
            text-align: center;
        }

        .header-img {
            width: 100%;
            height: auto;
        }

        /* Footer */
        .page-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 0 15mm 10mm 15mm;
            text-align: center;
        }

        .footer-img {
            width: 100%;
            max-width: 180mm;
            height: auto;
        }

        /* Blue Headers */
        .blue-header {
            background: #1e40af;
            color: white;
            text-align: center;
            padding: 2mm;
            font-weight: 700;
            font-size: 11pt;
            margin: 4mm 0 3mm;
            text-transform: uppercase;
        }

        /* Red Accent */
        .red {
            color: #dc2626;
        }

        .red-bold {
            color: #dc2626;
            font-weight: 700;
        }

        /* Reference Box */
        .ref-box {
            margin: 4mm 0;
            font-size: 10pt;
        }

        .ref-box p {
            margin: 1mm 0;
        }

        .rich-text p { margin-bottom: 1mm; }
        .rich-text ul, .rich-text ol { padding-left: 5mm; margin-bottom: 2mm; }
        .rich-text li { margin-bottom: 0.5mm; }

        /* Section Title */
        .section-title {
            font-size: 11pt;
            font-weight: 700;
            margin: 4mm 0 2mm;
            color: #1e40af;
        }

        /* Content Block */
        .content-block {
            display: flex;
            gap: 5mm;
            margin: 3mm 0;
        }

        .img-stack {
            flex: 0 0 45mm;
            display: flex;
            flex-direction: column;
            gap: 2mm;
        }

        .img-stack img {
            width: 100%;
            border: 0.5pt solid #ccc;
        }

        .text-content {
            flex: 1;
            text-align: justify;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 4mm 0;
        }

        th, td {
            border: 0.5pt solid #666;
            padding: 1.5mm 2mm;
            font-size: 9.5pt;
        }

        th {
            background: #f1f5f9;
            font-weight: 700;
            text-align: center;
        }

        /* Totals */
        .total-box {
            margin-top: 4mm;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .total-row {
            display: flex;
            width: 60mm;
            justify-content: space-between;
            padding: 1mm 0;
            border-bottom: 0.5pt solid #eee;
        }

        .grand-total {
            background: #dc2626;
            color: white;
            padding: 2mm;
            border-radius: 1mm;
            margin-top: 1mm;
            font-weight: 700;
        }

        .signature {
            margin-top: 10mm;
            font-size: 10pt;
        }

        @media print {
            .container { padding: 0; }
            .blue-header { -webkit-print-color-adjust: exact; background-color: #1e40af !important; }
            .grand-total { -webkit-print-color-adjust: exact; background-color: #dc2626 !important; }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <% if (assetImages['new_header.jpg']) { %>
                <img src="<%= assetImages['new_header.jpg'] %>" class="header-img">
            <% } %>
        </div>

        <!-- REFERENCE -->
        <div class="ref-box">
            <p><strong>Quotation No:</strong> <%= data.quoteNumber %></p>
            <p><strong>Date:</strong> <%= data.quoteDate %></p>
            
            <div style="margin-top: 2mm;" class="rich-text">
                <span style="font-weight: bold;">To:</span><br>
                <%- data.customerName %><br>
                <%- data.customerAddress %>
            </div>

            <div style="margin-top: 2mm;" class="rich-text">
                <span style="font-weight: bold;">Kind Attn:</span><br>
                <%- data.kindAttn %>
            </div>
            
            <div style="margin-top: 3mm;" class="rich-text">
                <%- data.referenceText %>
            </div>
        </div>

        <div class="blue-header">What sets Arvi apart from the rest? Let's take a closer look.</div>

        <div class="section-title">1. Truly Indian with <span class="red-bold">75 - 80% local content/ Indian components</span></div>

        <div class="content-block">
            <div class="img-stack">
                <% if (assetImages['IMG-20260205-WA0004.jpg']) { %>
                    <img src="<%= assetImages['IMG-20260205-WA0004.jpg'] %>">
                <% } %>
                <% if (assetImages['IMG-20260205-WA0010.jpg']) { %>
                    <img src="<%= assetImages['IMG-20260205-WA0010.jpg'] %>">
                <% } %>
            </div>
            <div class="text-content">
                <p>At a time when self-reliance is driving India’s industrial backbone, Arvi stands out with a 75 – 80% locally designed and manufactured product line. This indigenous approach not only ensures robust quality but also strengthens India’s vision of <strong>“ Make in India.”</strong></p>
                <p>Many so called manufacturers import UPS as semi knocked down kits and reassemble it in India under Make in India initiative; but the UPS design and its sub assembly are not Indian.</p>
                <p><em>"Every Arvi UPS is carefully engineered and subjected to 12 rigorous stages of quality inspection and heatrun; ensures minimum 10years of product life."</em></p>
            </div>
        </div>

        <div class="blue-header">Quotation Details</div>

        <div class="section-title">Option I - <span class="rich-text"><%- data.optionTitle %></span></div>
        <div style="margin-bottom: 3mm;" class="rich-text"><%- data.optionDetails %></div>

        <table>
            <thead>
                <tr>
                    <th style="width: 10mm;">Sl No</th>
                    <th>Description</th>
                    <th style="width: 25mm;">Unit Price</th>
                    <th style="width: 15mm;">Qty</th>
                    <th style="width: 30mm;">Value</th>
                </tr>
            </thead>
            <tbody>
                <% data.items.forEach(function(item) { %>
                <tr>
                    <td style="text-align: center;"><%= item.slno %></td>
                    <td class="rich-text"><%- item.description %></td>
                    <td style="text-align: right;"><%= item.unitPrice %></td>
                    <td style="text-align: center;"><%= item.qty %></td>
                    <td style="text-align: right;"><%= item.value %></td>
                </tr>
                <% }); %>
            </tbody>
        </table>

        <div class="total-box">
            <div class="total-row"><span>Subtotal:</span> <span>₹ <%= data.subtotal.toLocaleString('en-IN') %></span></div>
            <div class="total-row"><span>GST (18%):</span> <span>₹ <%= data.gstAmount.toLocaleString('en-IN') %></span></div>
            <div class="total-row grand-total"><span>Grand Total:</span> <span>₹ <%= data.grandTotal.toLocaleString('en-IN') %></span></div>
        </div>

        <div class="signature rich-text">
            <p>warm regards,</p>
            <%- data.signName %>
            <%- data.signDesig %>
            <p>For Arvi Systems & Controls Pvt Ltd</p>
        </div>

        <!-- FOOTER -->
        <div class="page-footer">
            <% if (assetImages['new_footer.jpg']) { %>
                <img src="<%= assetImages['new_footer.jpg'] %>" class="footer-img">
            <% } %>
        </div>
    </div>
</body>

</html>
